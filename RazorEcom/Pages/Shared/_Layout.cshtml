@* _Layout.cshtml *@
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - RazorEcom</title>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Bootstrap 5 CSS (Rất quan trọng cho layout) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

    <!--
         CSP Meta Tag (Giữ lại để đảm bảo an toàn và tải tài nguyên)
    -->
    <meta http-equiv="Content-Security-Policy"
          content="default-src 'self';
                   script-src 'self' 'unsafe-inline' https://code.jquery.com https://cdn.jsdelivr.net;
                   style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net;
                   font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net;
                   img-src 'self' https://source.unsplash.com https://placehold.co data: blob:;
                   connect-src 'self' https://localhost:7003 http://localhost:* ws://localhost:* wss://localhost:* https://cdn.jsdelivr.net;">

    <!-- Custom CSS -->
    <link href="~/css/site.css" rel="stylesheet" />

    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #1e1e1e; /* dark tone */
            color: #f0f0f0;
            padding-top: 56px; /* Thêm padding top để nội dung không bị che bởi navbar fixed-top */
            display: flex;
            flex-direction: column;
            min-height: 100vh; /* Đảm bảo footer luôn ở cuối */
        }

        a { color: #ff7f50; }
        a:hover { color: #ffa07a; text-decoration: none; }
        .navbar { background-color: #2b2b2b; }
        .footer { background-color: #2b2b2b; color: #ccc; padding: 2rem 0; margin-top: auto; /* Đẩy footer xuống cuối */ }
        .card { background-color: #2e2e2e; border: none; color: #f0f0f0; }
        .btn-primary { background-color: #ff7f50; border-color: #ff7f50; }
        .btn-primary:hover { background-color: #ffa07a; border-color: #ffa07a; }
        main { flex-grow: 1; /* Cho phép main content chiếm không gian còn lại */ }
        html { height: 100%; } /* Cần thiết cho min-height: 100vh trên body */

    </style>
</head>
<body>
    <!-- Header / Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark shadow-sm fixed-top"> @* Thêm fixed-top *@
        <div class="container">
            <a class="navbar-brand fw-bold" asp-page="/Index">RazorEcom</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"> <a class="nav-link" asp-page="/Index">Home</a> </li>
                    <li class="nav-item"> <a class="nav-link" asp-page="/Products/Index">Shop</a> </li>
                    <partial name="_LoginPartial" />
                </ul>
            </div>
        </div>
    </nav>

    <!-- Khu vực hiển thị thông báo TempData -->
    @if (TempData["success"] != null)
    {
        <!-- Thêm margin-top để không bị che bởi navbar -->
        <div class="alert alert-success alert-dismissible fade show position-fixed top-0 end-0 m-3" style="z-index: 1060; margin-top: 60px !important;" role="alert" id="tempDataAlertSuccess">
             <i class="bi bi-check-circle-fill me-2"></i> @TempData["success"]
             <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }
    @if (TempData["error"] != null)
    {
         <div class="alert alert-danger alert-dismissible fade show position-fixed top-0 end-0 m-3" style="z-index: 1060; margin-top: 60px !important;" role="alert" id="tempDataAlertError">
             <i class="bi bi-exclamation-triangle-fill me-2"></i> @TempData["error"]
             <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
         </div>
    }

    <!-- Main content -->
    <main class="container my-5">
        @RenderBody()
    </main>

    <!-- Footer -->
    <footer class="footer mt-auto">
        <div class="container text-center">
            <p>&copy; @DateTime.Now.Year RazorEcom. All rights reserved.</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        // Tự động ẩn thông báo TempData (Giữ lại phần này)
        document.addEventListener('DOMContentLoaded', function () {
            const tempDataAlertSuccess = document.getElementById('tempDataAlertSuccess');
            if (tempDataAlertSuccess) { setTimeout(() => { new bootstrap.Alert(tempDataAlertSuccess).close(); }, 5000); }
            const tempDataAlertError = document.getElementById('tempDataAlertError');
            if (tempDataAlertError) { setTimeout(() => { new bootstrap.Alert(tempDataAlertError).close(); }, 5000); }
        });
    </script>
    <!-- == KẾT THÚC SCRIPT == -->
    @RenderSection("Scripts", required: false)
</body>
</html>

